(window.webpackJsonp=window.webpackJsonp||[]).push([[52],{367:function(a,t,s){"use strict";s.r(t);var e=s(14),n=Object(e.a)({},(function(){var a=this,t=a._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[t("h1",{attrs:{id:"_5-2-使用canal进行mysql数据同步"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_5-2-使用canal进行mysql数据同步"}},[a._v("#")]),a._v(" 5.2 使用Canal进行MySQL数据同步")]),a._v(" "),t("h2",{attrs:{id:"_5-2-1-开启mysql的binlog模式"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_5-2-1-开启mysql的binlog模式"}},[a._v("#")]),a._v(" 5.2.1 开启MySQL的binlog模式")]),a._v(" "),t("p",[a._v("本书使用软件的版本")]),a._v(" "),t("table",[t("thead",[t("tr",[t("th",[a._v("软件")]),a._v(" "),t("th",[a._v("版本")])])]),a._v(" "),t("tbody",[t("tr",[t("td",[a._v("MySQL")]),a._v(" "),t("td",[a._v("5.7")])]),a._v(" "),t("tr",[t("td",[a._v("Canal")]),a._v(" "),t("td",[a._v("1.1.6")])]),a._v(" "),t("tr",[t("td",[a._v("Canal-Adapter")]),a._v(" "),t("td",[a._v("1.1.6")])])])]),a._v(" "),t("h3",{attrs:{id:"_1-开启mysql的binlog"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-开启mysql的binlog"}},[a._v("#")]),a._v(" 1. 开启MySQL的binlog")]),a._v(" "),t("p",[a._v("通过配置 /etc/my.cnf 或 /etc/mysql/mysql.conf.d/mysqld.cnf 配置文件的 log-bin 选项：")]),a._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("log_bin")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("ON\nserver-id"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("1001")]),a._v("\nbinlog-format"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("ROW\n")])])]),t("p",[a._v("配置后重启MySQL，根据语句查询是否开启")]),a._v(" "),t("h3",{attrs:{id:"_2-判断mysql是否已经开启binlog"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-判断mysql是否已经开启binlog"}},[a._v("#")]),a._v(" 2. 判断MySQL是否已经开启binlog")]),a._v(" "),t("div",{staticClass:"language-sql extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("show")]),a._v(" variables "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("like")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("'log_bin'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n")])])]),t("p",[t("code",[a._v("log_bin=on")]),a._v(" 表示开启")]),a._v(" "),t("h3",{attrs:{id:"_3-查看binlog模式"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-查看binlog模式"}},[a._v("#")]),a._v(" 3. 查看binlog模式")]),a._v(" "),t("div",{staticClass:"language-sql extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("show")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("global")]),a._v(" variables "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("like")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"binlog_format%"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n")])])]),t("p",[t("code",[a._v("binlog_format=row")]),a._v(" 表示行模式")]),a._v(" "),t("h2",{attrs:{id:"_5-2-2-安装kafka"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_5-2-2-安装kafka"}},[a._v("#")]),a._v(" 5.2.2 安装Kafka")]),a._v(" "),t("p",[a._v("安装Kafka参考："),t("a",{attrs:{href:"https://www.cnblogs.com/chaosopen/p/17831418.html",target:"_blank",rel:"noopener noreferrer"}},[a._v("点击查看"),t("OutboundLink")],1)]),a._v(" "),t("h2",{attrs:{id:"_5-2-3-安装canal"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_5-2-3-安装canal"}},[a._v("#")]),a._v(" 5.2.3 安装Canal")]),a._v(" "),t("p",[a._v("官方参考安装："),t("a",{attrs:{href:"https://github.com/alibaba/canal/wiki/QuickStart",target:"_blank",rel:"noopener noreferrer"}},[a._v("点击查看"),t("OutboundLink")],1)]),a._v(" "),t("h2",{attrs:{id:"_5-2-4-配置canal-adapter"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_5-2-4-配置canal-adapter"}},[a._v("#")]),a._v(" 5.2.4 配置Canal-Adapter")]),a._v(" "),t("p",[a._v("官方参考安装："),t("a",{attrs:{href:"https://github.com/alibaba/canal/wiki/Sync-ES",target:"_blank",rel:"noopener noreferrer"}},[a._v("点击查看"),t("OutboundLink")],1)]),a._v(" "),t("h2",{attrs:{id:"_5-2-5-canal和canal-adapter配置文件参考"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_5-2-5-canal和canal-adapter配置文件参考"}},[a._v("#")]),a._v(" 5.2.5 Canal和Canal-Adapter配置文件参考")]),a._v(" "),t("h3",{attrs:{id:"_1-canal-配置"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-canal-配置"}},[a._v("#")]),a._v(" 1. Canal 配置")]),a._v(" "),t("h4",{attrs:{id:"_1-修改-conf-canal-properties-以下配置"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-修改-conf-canal-properties-以下配置"}},[a._v("#")]),a._v(" 1. 修改 "),t("code",[a._v("conf/canal.properties")]),a._v(" 以下配置")]),a._v(" "),t("div",{staticClass:"language-properties extra-class"},[t("pre",{pre:!0,attrs:{class:"language-properties"}},[t("code",[t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("canal.serverMode")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("kafka")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("kafka.bootstrap.servers")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("127.0.0.1:9092")]),a._v("\n")])])]),t("h4",{attrs:{id:"_2-修改-conf-example-instance-properties-以下配置"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-修改-conf-example-instance-properties-以下配置"}},[a._v("#")]),a._v(" 2. 修改 "),t("code",[a._v("conf/example/instance.properties")]),a._v(" 以下配置")]),a._v(" "),t("div",{staticClass:"language-properties extra-class"},[t("pre",{pre:!0,attrs:{class:"language-properties"}},[t("code",[t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("canal.instance.master.address")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("127.0.0.1:3306")]),a._v("\n\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("canal.instance.dbUsername")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("root")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("canal.instance.dbPassword")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("123456")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("canal.instance.defaultDatabaseName")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("product_search")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("canal.instance.connectionCharset")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("UTF-8")]),a._v("\n\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("canal.mq.topic")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("test_topic")]),a._v("\n")])])]),t("h3",{attrs:{id:"_2-canal-adapter-配置"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-canal-adapter-配置"}},[a._v("#")]),a._v(" 2. Canal-Adapter 配置")]),a._v(" "),t("h4",{attrs:{id:"_1-修改-conf-application-yml-以下配置"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-修改-conf-application-yml-以下配置"}},[a._v("#")]),a._v(" 1. 修改 "),t("code",[a._v("conf/application.yml")]),a._v(" 以下配置")]),a._v(" "),t("div",{staticClass:"language-yml extra-class"},[t("pre",{pre:!0,attrs:{class:"language-yml"}},[t("code",[t("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("server")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("port")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("8081")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("spring")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("jackson")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("date-format")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" yyyy"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("-")]),a._v("MM"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("-")]),a._v("dd HH"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("mm"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("ss\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("time-zone")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" GMT+8\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("default-property-inclusion")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" non_null\n\n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("canal.conf")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("mode")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" kafka\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("flatMessage")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token boolean important"}},[a._v("true")]),a._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("zookeeperHosts")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("syncBatchSize")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("1000")]),a._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("retries")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("0")]),a._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("timeout")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("accessKey")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("secretKey")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("consumerProperties")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# kafka consumer")]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("kafka.bootstrap.servers")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" 127.0.0.1"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("9092")]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("kafka.enable.auto.commit")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token boolean important"}},[a._v("false")]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("kafka.auto.commit.interval.ms")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("1000")]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("kafka.auto.offset.reset")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" latest\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("kafka.request.timeout.ms")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("40000")]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("kafka.session.timeout.ms")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("30000")]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("kafka.isolation.level")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" read_committed\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("kafka.max.poll.records")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("1000")]),a._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("srcDataSources")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("defaultDS")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n      "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("url")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" jdbc"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("mysql"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("//127.0.0.1"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("3306/product_search"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("?")]),a._v("useUnicode=true\n      "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("username")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" root\n      "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("password")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("123456")]),a._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("canalAdapters")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n  "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("-")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("instance")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" test_topic\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("groups")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("-")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("groupId")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" g1\n      "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("outerAdapters")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n      "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("-")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("name")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" es7\n        "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("key")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" example\n        "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("hosts")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" http"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("//127.0.0.1"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("9200")]),a._v("\n        "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("properties")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n          "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("mode")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" rest\n          "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("cluster.name")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" elasticsearch\n")])])]),t("h4",{attrs:{id:"_1-修改-conf-es7-mytest-user-yml-以下配置"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-修改-conf-es7-mytest-user-yml-以下配置"}},[a._v("#")]),a._v(" 1. 修改 "),t("code",[a._v("conf/es7/mytest_user.yml")]),a._v(" 以下配置")]),a._v(" "),t("div",{staticClass:"language-yml extra-class"},[t("pre",{pre:!0,attrs:{class:"language-yml"}},[t("code",[t("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("dataSourceKey")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" defaultDS\n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("destination")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" test_topic\n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("groupId")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" g1\n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("outerAdapterKey")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" example\n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("esMapping")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("_index")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" product_index\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("_id")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" _id\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("upsert")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token boolean important"}},[a._v("false")]),a._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("sql")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("\"SELECT a.id as _id,a.spu_id as spuId,a.category_name as categoryName,a.product_name as productName,a.price,a.attrs,DATE_FORMAT(a.updated_time,'%Y-%m-%d %H:%i:%s') updateTime,DATE_FORMAT(a.created_time,'%Y-%m-%d %H:%i:%s') createTime FROM sku_info a\"")]),a._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("objFields")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("attrs")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" object\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("etlCondition")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"where updated_time>={0}"')]),a._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("commitBatch")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("3000")]),a._v("\n")])])]),t("h2",{attrs:{id:"_5-2-6-测试数据监听发送"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_5-2-6-测试数据监听发送"}},[a._v("#")]),a._v(" 5.2.6 测试数据监听发送")]),a._v(" "),t("h3",{attrs:{id:"_1-canal-adapter同步mysql数据"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-canal-adapter同步mysql数据"}},[a._v("#")]),a._v(" 1. Canal-Adapter同步MySQL数据")]),a._v(" "),t("p",[a._v("请求canal-adapter同步接口")]),a._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[a._v("http://127.0.0.1:8081/etl/es7/mytest_user.yml\n")])])]),t("h3",{attrs:{id:"_2-验证es是否接收数据"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-验证es是否接收数据"}},[a._v("#")]),a._v(" 2. 验证ES是否接收数据")]),a._v(" "),t("div",{staticClass:"language-json extra-class"},[t("pre",{pre:!0,attrs:{class:"language-json"}},[t("code",[a._v("GET product_index/_search\n")])])]),t("p",[t("strong",[a._v("ES有数据说明同步成功")])])])}),[],!1,null,null,null);t.default=n.exports}}]);