<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>2.4 字段类型介绍 | 《ElasticSearch入门到实战》电子书</title>
    <meta name="generator" content="VuePress 1.9.10">
    <script>var _hmt = _hmt || [];
        (function() {
          var hm = document.createElement("script");
          hm.src = "https://hm.baidu.com/hm.js?cf62495503806b1a59f15409bcb76089";
          var s = document.getElementsByTagName("script")[0]; 
          s.parentNode.insertBefore(hm, s);
        })();</script>
    <meta name="description" content="">
    <meta name="keywords" content="elasticsearch,es教程,elasticsearch入门指南,数据分析">
    
    <link rel="preload" href="/assets/css/0.styles.f047b2b2.css" as="style"><link rel="preload" href="/assets/js/app.dac35002.js" as="script"><link rel="preload" href="/assets/js/4.25d5dc7a.js" as="script"><link rel="preload" href="/assets/js/1.564e4eb6.js" as="script"><link rel="preload" href="/assets/js/28.485f0a88.js" as="script"><link rel="prefetch" href="/assets/js/11.8c57c1b0.js"><link rel="prefetch" href="/assets/js/12.329360ff.js"><link rel="prefetch" href="/assets/js/13.2dfa8441.js"><link rel="prefetch" href="/assets/js/14.963874c8.js"><link rel="prefetch" href="/assets/js/15.6dbae529.js"><link rel="prefetch" href="/assets/js/16.f6c4da71.js"><link rel="prefetch" href="/assets/js/17.f2ca5f26.js"><link rel="prefetch" href="/assets/js/18.df451456.js"><link rel="prefetch" href="/assets/js/19.5b9a9a13.js"><link rel="prefetch" href="/assets/js/2.c6d91782.js"><link rel="prefetch" href="/assets/js/20.7c522e7f.js"><link rel="prefetch" href="/assets/js/21.7f352adf.js"><link rel="prefetch" href="/assets/js/22.9732dad4.js"><link rel="prefetch" href="/assets/js/23.4c4bb30d.js"><link rel="prefetch" href="/assets/js/24.ef57e072.js"><link rel="prefetch" href="/assets/js/25.738f307f.js"><link rel="prefetch" href="/assets/js/26.a4ef7a52.js"><link rel="prefetch" href="/assets/js/27.45a94793.js"><link rel="prefetch" href="/assets/js/29.adadd52b.js"><link rel="prefetch" href="/assets/js/3.2179dc6c.js"><link rel="prefetch" href="/assets/js/30.89d97153.js"><link rel="prefetch" href="/assets/js/31.83ce7812.js"><link rel="prefetch" href="/assets/js/32.77030c5b.js"><link rel="prefetch" href="/assets/js/33.3fa93b8c.js"><link rel="prefetch" href="/assets/js/34.8abf2e7f.js"><link rel="prefetch" href="/assets/js/35.a359c415.js"><link rel="prefetch" href="/assets/js/36.ca4535ef.js"><link rel="prefetch" href="/assets/js/37.c28c38d4.js"><link rel="prefetch" href="/assets/js/38.6dbac488.js"><link rel="prefetch" href="/assets/js/39.c5013730.js"><link rel="prefetch" href="/assets/js/40.1dc39e50.js"><link rel="prefetch" href="/assets/js/41.724c909a.js"><link rel="prefetch" href="/assets/js/42.6961e5a8.js"><link rel="prefetch" href="/assets/js/43.2498bf23.js"><link rel="prefetch" href="/assets/js/44.07a834a8.js"><link rel="prefetch" href="/assets/js/45.b09417df.js"><link rel="prefetch" href="/assets/js/46.04196af1.js"><link rel="prefetch" href="/assets/js/47.aa588963.js"><link rel="prefetch" href="/assets/js/48.20ef08ca.js"><link rel="prefetch" href="/assets/js/49.637d1f34.js"><link rel="prefetch" href="/assets/js/5.1e3174d7.js"><link rel="prefetch" href="/assets/js/50.58f90e0f.js"><link rel="prefetch" href="/assets/js/51.786432e8.js"><link rel="prefetch" href="/assets/js/52.03a9b628.js"><link rel="prefetch" href="/assets/js/53.5d20f2f2.js"><link rel="prefetch" href="/assets/js/54.687ea780.js"><link rel="prefetch" href="/assets/js/55.b301d29b.js"><link rel="prefetch" href="/assets/js/56.fb9f453d.js"><link rel="prefetch" href="/assets/js/57.b761f294.js"><link rel="prefetch" href="/assets/js/58.18734ce0.js"><link rel="prefetch" href="/assets/js/59.17fb3b41.js"><link rel="prefetch" href="/assets/js/6.49dd7821.js"><link rel="prefetch" href="/assets/js/60.21cbf1ab.js"><link rel="prefetch" href="/assets/js/61.c6730ca7.js"><link rel="prefetch" href="/assets/js/62.c97f6f80.js"><link rel="prefetch" href="/assets/js/63.3dbc36d7.js"><link rel="prefetch" href="/assets/js/64.dc6cc472.js"><link rel="prefetch" href="/assets/js/7.71819138.js"><link rel="prefetch" href="/assets/js/8.f5318518.js"><link rel="prefetch" href="/assets/js/vendors~docsearch.0928da61.js">
    <link rel="stylesheet" href="/assets/css/0.styles.f047b2b2.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">《ElasticSearch入门到实战》电子书</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">
  主页
</a></div><div class="nav-item"><a href="/guide/" class="nav-link">
  一起交流
</a></div><div class="nav-item"><a href="/sponsor.html" class="nav-link">
  赞助
</a></div><div class="nav-item"><a href="https://github.com/chaosopen/elasticsearch_in_action" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">
  主页
</a></div><div class="nav-item"><a href="/guide/" class="nav-link">
  一起交流
</a></div><div class="nav-item"><a href="/sponsor.html" class="nav-link">
  赞助
</a></div><div class="nav-item"><a href="https://github.com/chaosopen/elasticsearch_in_action" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/" aria-current="page" class="sidebar-link">首页</a></li><li><section class="sidebar-group depth-0"><a href="/chapter1/index" class="sidebar-heading clickable"><span>第一章：起步</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/chapter1/elastic_search_intro.html" class="sidebar-link">1.1 初识ElasticSearch</a></li><li><a href="/chapter1/install_elastic_search.html" class="sidebar-link">1.2 搭建ElasticSearch环境</a></li><li><a href="/chapter1/elastic_search_client.html" class="sidebar-link">1.3 ElasticSearch客户端</a></li><li><a href="/chapter1/elastic_search_client_coding.html" class="sidebar-link">1.4 程序连接ElasticSearch</a></li></ul></section></li><li><section class="sidebar-group depth-0"><a href="/chapter2/index" class="sidebar-heading clickable open"><span>第二章：ElasticSearch基础操作</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/chapter2/index_operation.html" class="sidebar-link">2.1 索引操作</a></li><li><a href="/chapter2/mapping_operation.html" class="sidebar-link">2.2 映射操作</a></li><li><a href="/chapter2/document_operation.html" class="sidebar-link">2.3 文档数据操作</a></li><li><a href="/chapter2/field_type_intro.html" aria-current="page" class="active sidebar-link">2.4 字段类型介绍</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/chapter2/field_type_intro.html#_2-4-1-什么是倒排索引" class="sidebar-link">2.4.1 什么是倒排索引</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/chapter2/field_type_intro.html#_1-正向索引" class="sidebar-link">1. 正向索引</a></li><li class="sidebar-sub-header"><a href="/chapter2/field_type_intro.html#_2-倒排索引" class="sidebar-link">2. 倒排索引</a></li></ul></li><li class="sidebar-sub-header"><a href="/chapter2/field_type_intro.html#_2-4-2-基础数据类型" class="sidebar-link">2.4.2 基础数据类型</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/chapter2/field_type_intro.html#_1-keyword类型" class="sidebar-link">1. keyword类型</a></li><li class="sidebar-sub-header"><a href="/chapter2/field_type_intro.html#_2-text类型" class="sidebar-link">2. text类型</a></li><li class="sidebar-sub-header"><a href="/chapter2/field_type_intro.html#_3-数值类型" class="sidebar-link">3. 数值类型</a></li><li class="sidebar-sub-header"><a href="/chapter2/field_type_intro.html#_4-布尔类型" class="sidebar-link">4. 布尔类型</a></li><li class="sidebar-sub-header"><a href="/chapter2/field_type_intro.html#_5-日期类型" class="sidebar-link">5. 日期类型</a></li></ul></li><li class="sidebar-sub-header"><a href="/chapter2/field_type_intro.html#_2-4-3-复杂数据类型" class="sidebar-link">2.4.3 复杂数据类型</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/chapter2/field_type_intro.html#_1-对象类型-object" class="sidebar-link">1. 对象类型（object）</a></li><li class="sidebar-sub-header"><a href="/chapter2/field_type_intro.html#_2-数组类型" class="sidebar-link">2. 数组类型</a></li><li class="sidebar-sub-header"><a href="/chapter2/field_type_intro.html#_3-嵌套文档-nested" class="sidebar-link">3. 嵌套文档（nested）</a></li><li class="sidebar-sub-header"><a href="/chapter2/field_type_intro.html#_4-子字段" class="sidebar-link">4. 子字段</a></li><li class="sidebar-sub-header"><a href="/chapter2/field_type_intro.html#_5-地理类型" class="sidebar-link">5. 地理类型</a></li></ul></li></ul></li><li><a href="/chapter2/segment_word_search.html" class="sidebar-link">2.5 分词操作介绍</a></li></ul></section></li><li><section class="sidebar-group depth-0"><a href="/chapter3/index" class="sidebar-heading clickable"><span>第三章：ElasticSearch进阶高级操作</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/chapter3/select_grammar.html" class="sidebar-link">3.1 查询语法</a></li><li><a href="/chapter3/rank_search.html" class="sidebar-link">3.2 排序</a></li><li><a href="/chapter3/aggs_search.html" class="sidebar-link">3.3 聚合搜索</a></li><li><a href="/chapter3/monitor.html" class="sidebar-link">3.4 ES状态监控</a></li></ul></section></li><li><section class="sidebar-group depth-0"><a href="/chapter4/index" class="sidebar-heading clickable"><span>第四章：抽丝剥茧深入底层精通ES</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/chapter4/architecture_design.html" class="sidebar-link">4.1 架构设计</a></li><li><a href="/chapter4/workflow.html" class="sidebar-link">4.2 内部工作流程</a></li><li><a href="/chapter4/inverted_index.html" class="sidebar-link">4.3 深入理解倒排索引</a></li><li><a href="/chapter4/score_model.html" class="sidebar-link">4.4 评分模型</a></li><li><a href="/chapter4/election_mechanism.html" class="sidebar-link">4.5 ES中Master选举机制</a></li><li><a href="/chapter4/data_buffer.html" class="sidebar-link">4.6 内部缓存原理</a></li></ul></section></li><li><section class="sidebar-group depth-0"><a href="/chapter5/index" class="sidebar-heading clickable"><span>第五章：电商搜索引擎实战</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/chapter5/search_architecture.html" class="sidebar-link">5.1 搜索引擎架构设计</a></li><li><a href="/chapter5/canal_mysql_sync_data.html" class="sidebar-link">5.2 使用Canal进行MySQL数据同步</a></li><li><a href="/chapter5/project_write.html" class="sidebar-link">5.3 搜索实战项目示例</a></li></ul></section></li><li><section class="sidebar-group depth-0"><a href="/chapter6/index" class="sidebar-heading clickable"><span>第六章：高阶API文档</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/chapter6/query_operation.html" class="sidebar-link">6.1 查询相关操作</a></li><li><a href="/chapter6/update_operation.html" class="sidebar-link">6.2 修改相关操作</a></li></ul></section></li><li><section class="sidebar-group depth-0"><a href="/chapter7/index" class="sidebar-heading clickable"><span>第七章：ES性能优化</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/chapter7/deploy_optimization.html" class="sidebar-link">7.1 部署优化</a></li><li><a href="/chapter7/run_optimization.html" class="sidebar-link">7.2 运行时优化</a></li></ul></section></li><li><section class="sidebar-group depth-0"><a href="/issues/index" class="sidebar-heading clickable"><span>ES错误解决方案</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/issues/install_issue.html" class="sidebar-link">1. 安装错误</a></li></ul></section></li><li><a href="/sponsor.html" class="sidebar-link">赞助</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="_2-4-字段类型介绍"><a href="#_2-4-字段类型介绍" class="header-anchor">#</a> 2.4 字段类型介绍</h1> <p>学习了文档操作后，基本已经入门ES了，我们会见到书中举例的一些数据类型，到本章节我们详细介绍ES中的基本数据类型和复杂的数据类型。不过在此之前要先带大家了解下<code>倒排索引</code>。</p> <h2 id="_2-4-1-什么是倒排索引"><a href="#_2-4-1-什么是倒排索引" class="header-anchor">#</a> 2.4.1 什么是倒排索引</h2> <p>ES采用的是倒排索引（Inverted Index）存储数据, 也称为反向索引。 有反向索引，也会有正向索引。</p> <p>俗话说的好：<strong>生平不识倒排索引,学懂ES也枉然</strong>。这是ES的核(面)心(试)点(题)。</p> <h3 id="_1-正向索引"><a href="#_1-正向索引" class="header-anchor">#</a> 1. 正向索引</h3> <p>正排索引是以文档的ID作为关键字，并且记录文档中每个字段的值信息，通过查询id来把整条文档拿出来。</p> <p>但是在查询某一个keyword存在于哪些文档的时候， 需要对所有文档进行扫描匹配。这样检索效率比较低下。</p> <p><img src="data:image/png;base64,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" alt="图2-6"></p> <h3 id="_2-倒排索引"><a href="#_2-倒排索引" class="header-anchor">#</a> 2. 倒排索引</h3> <p>倒排索引以字或词作为关键字索引，去找对应ID， 倒排索引建立的是分词（Term）和文档（Document）之间的映射关系。</p> <p><img src="data:image/png;base64,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" alt="图2-7"></p> <p>对于0基础的同学如果还不懂，可以先用Map的结构理解，后续我们会更详细讲解。</p> <blockquote><p>把关键词作为Key，对应数据的ID作为value的list集合，通过关键词查询一组对应的ID数据</p></blockquote> <p>举个例子：</p> <blockquote><p>数据集：[{&quot;id&quot;:1, &quot;name&quot;: java},{&quot;id&quot;:2, &quot;name&quot;: java},{&quot;id&quot;:3, &quot;name&quot;: golang}]<br>
map定义：(java)=[1,2]，(golang)=[3]<br>
查询过程就是拿关键词java查询ID，获取ID为1、2，然后将整条数据返回给我们</p></blockquote> <p><strong><font color="red">具体实现过程肯定不是这样，但是为了新手容易理解，先对倒排索引有初步概念，后续会详细讲解倒排索引</font></strong></p> <h2 id="_2-4-2-基础数据类型"><a href="#_2-4-2-基础数据类型" class="header-anchor">#</a> 2.4.2 基础数据类型</h2> <h3 id="_1-keyword类型"><a href="#_1-keyword类型" class="header-anchor">#</a> 1. keyword类型</h3> <p><code>keyword</code> 类型是 <code>不进行分词</code> 的字符串类型，可以理解数据库的字符串类型，<code>不进行分词</code> 含义指的是：不会对keyword字段内容进行分词，直接构建 <code>倒排索引</code> ，keyword类型应用场景比较多，一般用于对文档的过滤、排序和聚合等。</p> <p>添加 <code>keyword</code> 映射字段</p> <div class="language-json extra-class"><pre class="language-json"><code>POST indexname/_mapping
<span class="token punctuation">{</span>
  <span class="token property">&quot;properties&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>
    <span class="token property">&quot;remarks&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>
      <span class="token property">&quot;type&quot;</span><span class="token operator">:</span><span class="token string">&quot;keyword&quot;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="_2-text类型"><a href="#_2-text类型" class="header-anchor">#</a> 2. text类型</h3> <p><code>text</code> 类型是可进行切分的字符串类型。这里的 <code>可切分</code> 指的是：在索引时，可按照相应的切词算法对文本内容进行切分，然后构建倒排索引；</p> <p>添加 <code>text</code> 映射字段</p> <div class="language-json extra-class"><pre class="language-json"><code>POST indexname/_mapping
<span class="token punctuation">{</span>
  <span class="token property">&quot;properties&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>
    <span class="token property">&quot;summary&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>
      <span class="token property">&quot;type&quot;</span><span class="token operator">:</span><span class="token string">&quot;text&quot;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="_3-数值类型"><a href="#_3-数值类型" class="header-anchor">#</a> 3. 数值类型</h3> <p>ES支持的数值类型</p> <ul><li>long -- 带符号的64位整数，最小值-263，最大值263-1</li> <li>integer -- 带符号的32位整数，最小值-231，最大值231-1</li> <li>short -- 带符号的16位整数，最小值-32768，最大值32767</li> <li>byte -- 带符号的8位整数，最小值-128，最小值127</li> <li>double -- 双精度64位IEEE 754 浮点数</li> <li>float -- 单精度32位IEEE 754 浮点数</li> <li>half_float -- 半精度16位IEEE 754 浮点数</li> <li>scaled_float -- 带有缩放因子的缩放类型浮点数</li></ul> <p>添加 <code>integer</code> 映射字段</p> <div class="language-json extra-class"><pre class="language-json"><code>POST indexname/_mapping
<span class="token punctuation">{</span>
  <span class="token property">&quot;properties&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>
    <span class="token property">&quot;age&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>
      <span class="token property">&quot;type&quot;</span><span class="token operator">:</span><span class="token string">&quot;integer&quot;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>为节约存储空间并提升搜索和索引的效率，因为 <strong><code>内存很贵</code></strong>，在实际应用中，在满足需求的情况下应尽可能选择范围小的数据类型。</p> <h3 id="_4-布尔类型"><a href="#_4-布尔类型" class="header-anchor">#</a> 4. 布尔类型</h3> <p><code>boolean</code> 类型用于业务中的二值表示，例如商品是否上架、数据是否失效。</p> <p>添加 <code>boolean</code> 映射字段</p> <div class="language-json extra-class"><pre class="language-json"><code>POST indexname/_mapping
<span class="token punctuation">{</span>
  <span class="token property">&quot;properties&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>
    <span class="token property">&quot;isAdmin&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>
      <span class="token property">&quot;type&quot;</span><span class="token operator">:</span><span class="token string">&quot;boolean&quot;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="_5-日期类型"><a href="#_5-日期类型" class="header-anchor">#</a> 5. 日期类型</h3> <p><code>date</code> 类型用于存储日期</p> <p>一般使用如下形式表示日期类型数据：</p> <ul><li>格式化的日期字符串</li> <li>毫秒级的长整型，表示从1970年1月1日0点到现在的毫秒数</li> <li>秒级别的整型，表示从1970年1月1日0点到现在的秒数。</li> <li>日期类型的默认格式为strict_date_time||epoch_millis.其中，strict_date_optional_time的含义是严格的时间类型，支持yyyy-MM-dd、yyyyMMdd、yyyyMMddHHmmss、yyyy-MM-ddTHH:mm:ss、yyyy-MM-ddTHH:mm:ss.SSS和yyyy-MM-ddTHH:mm:ss.SSSZ等格式，epoch_millis的含义是从1970年1月1日0点到现在的毫秒数。</li></ul> <p>添加 <code>date</code> 映射字段</p> <div class="language-json extra-class"><pre class="language-json"><code>POST indexname/_mapping
<span class="token punctuation">{</span>
  <span class="token property">&quot;properties&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>
    <span class="token property">&quot;createTime&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>
      <span class="token property">&quot;type&quot;</span><span class="token operator">:</span><span class="token string">&quot;date&quot;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="_2-4-3-复杂数据类型"><a href="#_2-4-3-复杂数据类型" class="header-anchor">#</a> 2.4.3 复杂数据类型</h2> <h3 id="_1-对象类型-object"><a href="#_1-对象类型-object" class="header-anchor">#</a> 1. 对象类型（object）</h3> <p>一个字段下需要多种类型的属性字段，属性 <code>attr</code> 有身高、体重，添加映射语句如下：</p> <div class="language-json extra-class"><pre class="language-json"><code>POST indexname/_mapping
<span class="token punctuation">{</span>
  <span class="token property">&quot;properties&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;attr&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">&quot;properties&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;height&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;double&quot;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token property">&quot;weight&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;double&quot;</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>对象类型新增数据语法</p> <div class="language-json extra-class"><pre class="language-json"><code>PUT indexname/_doc/<span class="token number">1</span>
<span class="token punctuation">{</span>
  <span class="token property">&quot;attr&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;height&quot;</span><span class="token operator">:</span> <span class="token number">176.3</span><span class="token punctuation">,</span>
    <span class="token property">&quot;weight&quot;</span><span class="token operator">:</span> <span class="token number">64</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>筛选查询新增的数据</p> <div class="language-json extra-class"><pre class="language-json"><code>GET indexname/_search
<span class="token punctuation">{</span>
  <span class="token property">&quot;query&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>
    <span class="token property">&quot;term&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>
      <span class="token property">&quot;attr.weight&quot;</span><span class="token operator">:</span> <span class="token string">&quot;64&quot;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="_2-数组类型"><a href="#_2-数组类型" class="header-anchor">#</a> 2. 数组类型</h3> <p>ELasticsearch没有专用的数组类型，默认情况下任何字段都可以包含一个或者多个值，但是一个数组中的值要是同一种类型。</p> <ul><li>字符数组: [ &quot;one&quot;, &quot;two&quot; ]</li> <li>整型数组：[1,3]</li> <li>对象数组：[ { &quot;name&quot;: &quot;长度&quot;, &quot;value&quot;: &quot;10&quot; }, { &quot;name&quot;: &quot;内存&quot;, &quot;value&quot;: &quot;16&quot; }]</li></ul> <p>keyword数组，创建keyword字段</p> <div class="language-json extra-class"><pre class="language-json"><code>POST indexname/_mapping
<span class="token punctuation">{</span>
  <span class="token property">&quot;properties&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;skills&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;keyword&quot;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>新增数据</p> <div class="language-json extra-class"><pre class="language-json"><code>PUT indexname/_doc/<span class="token number">2</span>
<span class="token punctuation">{</span>
  <span class="token property">&quot;skills&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;java&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;c++&quot;</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre></div><p>对象数组，创建对象字段</p> <div class="language-json extra-class"><pre class="language-json"><code>POST indexname/_mapping
<span class="token punctuation">{</span>
  <span class="token property">&quot;properties&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;attrs&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">&quot;properties&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;keyword&quot;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token property">&quot;value&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;keyword&quot;</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>新增数据</p> <div class="language-json extra-class"><pre class="language-json"><code>PUT indexname/_doc/<span class="token number">3</span>
<span class="token punctuation">{</span>
  <span class="token property">&quot;attrs&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
      <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;长度&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;value&quot;</span><span class="token operator">:</span> <span class="token string">&quot;10&quot;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span>
      <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;内存&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;value&quot;</span><span class="token operator">:</span> <span class="token string">&quot;16&quot;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="_3-嵌套文档-nested"><a href="#_3-嵌套文档-nested" class="header-anchor">#</a> 3. 嵌套文档（nested）</h3> <p>nested嵌套类型是object中的一个特例，可以让<code>对象数组</code>类型独立索引和查询。</p> <p>项目场景中弥补对象数组的一些查询问题</p> <p>接着前面创建的对象数组 <code>attrs</code> 先添加几条数据</p> <div class="language-json extra-class"><pre class="language-json"><code>POST _bulk
<span class="token punctuation">{</span><span class="token property">&quot;create&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token property">&quot;_index&quot;</span><span class="token operator">:</span><span class="token string">&quot;indexname&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;_id&quot;</span><span class="token operator">:</span><span class="token number">20</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token property">&quot;attrs&quot;</span><span class="token operator">:</span><span class="token punctuation">[</span><span class="token punctuation">{</span><span class="token property">&quot;name&quot;</span><span class="token operator">:</span><span class="token string">&quot;长度&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;value&quot;</span><span class="token operator">:</span><span class="token string">&quot;64&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">{</span><span class="token property">&quot;name&quot;</span><span class="token operator">:</span><span class="token string">&quot;内存&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;value&quot;</span><span class="token operator">:</span><span class="token string">&quot;32&quot;</span><span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token property">&quot;create&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token property">&quot;_index&quot;</span><span class="token operator">:</span><span class="token string">&quot;indexname&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;_id&quot;</span><span class="token operator">:</span><span class="token number">21</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token property">&quot;attrs&quot;</span><span class="token operator">:</span><span class="token punctuation">[</span><span class="token punctuation">{</span><span class="token property">&quot;name&quot;</span><span class="token operator">:</span><span class="token string">&quot;长度&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;value&quot;</span><span class="token operator">:</span><span class="token string">&quot;64&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">{</span><span class="token property">&quot;name&quot;</span><span class="token operator">:</span><span class="token string">&quot;内存&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;value&quot;</span><span class="token operator">:</span><span class="token string">&quot;64&quot;</span><span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token property">&quot;create&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token property">&quot;_index&quot;</span><span class="token operator">:</span><span class="token string">&quot;indexname&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;_id&quot;</span><span class="token operator">:</span><span class="token number">22</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token property">&quot;attrs&quot;</span><span class="token operator">:</span><span class="token punctuation">[</span><span class="token punctuation">{</span><span class="token property">&quot;name&quot;</span><span class="token operator">:</span><span class="token string">&quot;长度&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;value&quot;</span><span class="token operator">:</span><span class="token string">&quot;64&quot;</span><span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">}</span>
</code></pre></div><p>现在业务需求：需要 <code>属性=长度 且 值=32</code> 的数据（目前数据里没有），我们来写查询语法。</p> <div class="language-json extra-class"><pre class="language-json"><code>GET indexname/_search
<span class="token punctuation">{</span>
  <span class="token property">&quot;query&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;bool&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">&quot;must&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{</span>
          <span class="token property">&quot;term&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token property">&quot;attrs.name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;长度&quot;</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>
          <span class="token property">&quot;term&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token property">&quot;attrs.value&quot;</span><span class="token operator">:</span> <span class="token string">&quot;32&quot;</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><blockquote><p>运行后发现居然有数据，为什么呢？我们后面原理篇会讲。</p> <p>怎么解决这种问题呢？使用 <code>nested</code> 类型即可解决。</p></blockquote> <p>添加映射字段</p> <div class="language-json extra-class"><pre class="language-json"><code>POST indexname/_mapping
<span class="token punctuation">{</span>
  <span class="token property">&quot;properties&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;attrsNested&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;nested&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;properties&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;keyword&quot;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token property">&quot;value&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;keyword&quot;</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>添加几条数据</p> <div class="language-json extra-class"><pre class="language-json"><code>POST _bulk
<span class="token punctuation">{</span><span class="token property">&quot;create&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token property">&quot;_index&quot;</span><span class="token operator">:</span><span class="token string">&quot;indexname&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;_id&quot;</span><span class="token operator">:</span><span class="token number">20</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token property">&quot;attrsNested&quot;</span><span class="token operator">:</span><span class="token punctuation">[</span><span class="token punctuation">{</span><span class="token property">&quot;name&quot;</span><span class="token operator">:</span><span class="token string">&quot;长度&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;value&quot;</span><span class="token operator">:</span><span class="token string">&quot;64&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">{</span><span class="token property">&quot;name&quot;</span><span class="token operator">:</span><span class="token string">&quot;内存&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;value&quot;</span><span class="token operator">:</span><span class="token string">&quot;32&quot;</span><span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token property">&quot;create&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token property">&quot;_index&quot;</span><span class="token operator">:</span><span class="token string">&quot;indexname&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;_id&quot;</span><span class="token operator">:</span><span class="token number">21</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token property">&quot;attrsNested&quot;</span><span class="token operator">:</span><span class="token punctuation">[</span><span class="token punctuation">{</span><span class="token property">&quot;name&quot;</span><span class="token operator">:</span><span class="token string">&quot;长度&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;value&quot;</span><span class="token operator">:</span><span class="token string">&quot;64&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">{</span><span class="token property">&quot;name&quot;</span><span class="token operator">:</span><span class="token string">&quot;内存&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;value&quot;</span><span class="token operator">:</span><span class="token string">&quot;64&quot;</span><span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token property">&quot;create&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token property">&quot;_index&quot;</span><span class="token operator">:</span><span class="token string">&quot;indexname&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;_id&quot;</span><span class="token operator">:</span><span class="token number">22</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token property">&quot;attrsNested&quot;</span><span class="token operator">:</span><span class="token punctuation">[</span><span class="token punctuation">{</span><span class="token property">&quot;name&quot;</span><span class="token operator">:</span><span class="token string">&quot;长度&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;value&quot;</span><span class="token operator">:</span><span class="token string">&quot;64&quot;</span><span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">}</span>
</code></pre></div><p>查询数据</p> <div class="language-json extra-class"><pre class="language-json"><code>GET indexname/_search
<span class="token punctuation">{</span>
  <span class="token property">&quot;query&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;nested&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">&quot;path&quot;</span><span class="token operator">:</span> <span class="token string">&quot;attrsNested&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;query&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;bool&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token property">&quot;must&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
            <span class="token punctuation">{</span>
              <span class="token property">&quot;term&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                <span class="token property">&quot;attrsNested.name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;长度&quot;</span>
              <span class="token punctuation">}</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">{</span>
              <span class="token property">&quot;term&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                <span class="token property">&quot;attrsNested.value&quot;</span><span class="token operator">:</span> <span class="token string">&quot;32&quot;</span>
              <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
          <span class="token punctuation">]</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>已经查不到数据了，问题完美解决</p> <h3 id="_4-子字段"><a href="#_4-子字段" class="header-anchor">#</a> 4. 子字段</h3> <p><code>text</code>类型不能用于排序、聚合。为什么呢？因为它的属性 <code>fielddata</code> 默认是false，设置为true就可以了，但是不建议使用，会增加内存的压力。</p> <p>添加字段映射（不建议设置true）：</p> <div class="language-json extra-class"><pre class="language-json"><code>POST indexname/_mapping
<span class="token punctuation">{</span>
  <span class="token property">&quot;properties&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;address&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;text&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;fielddata&quot;</span><span class="token operator">:</span><span class="token boolean">true</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>直接使用 <code>keyword</code> 类型可以进行排序、聚合。</p> <p>想必会有同学有疑问：</p> <blockquote><p>同样是字符串类型，干脆直接都用keyword类型不就行了。</p></blockquote> <p>如果你不需要 <code>分词</code> 那么你用keyword完全可以，如果你需要对字段值分词，那你还是需要用text。</p> <p>那么有没有不增加压力，而且不用两个字段的方法呢？ 当然有，就是做子字段！</p> <div class="language-json extra-class"><pre class="language-json"><code>POST indexname/_mapping
<span class="token punctuation">{</span>
  <span class="token property">&quot;properties&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;address&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;text&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;fields&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;keyword&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;keyword&quot;</span><span class="token punctuation">,</span>
          <span class="token property">&quot;ignore_above&quot;</span><span class="token operator">:</span> <span class="token number">256</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p><code>address</code> 字段下增加了 <code>keyword</code> 名字的字段，类型是 <code>keyword</code>，设置256长度</p> <p>对应查询子字段<code>keyword</code>的语句</p> <div class="language-json extra-class"><pre class="language-json"><code>GET indexname/_search
<span class="token punctuation">{</span>
  <span class="token property">&quot;query&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;term&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>
      <span class="token property">&quot;address.keyword&quot;</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="_5-地理类型"><a href="#_5-地理类型" class="header-anchor">#</a> 5. 地理类型</h3> <p><code>geo_point</code> 是地理类型。移动互联网的时代，移动设备越来越多，要根据地理位置搜索地址，可以把地址的经纬度数据设置地理数据类型。</p> <div class="language-json extra-class"><pre class="language-json"><code>POST indexname/_mapping
<span class="token punctuation">{</span>
  <span class="token property">&quot;properties&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;location&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;geo_point&quot;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>添加一条地理位置数据</p> <div class="language-json extra-class"><pre class="language-json"><code>PUT indexname/_doc/<span class="token number">6</span>
<span class="token punctuation">{</span>
  <span class="token property">&quot;location&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;lat&quot;</span><span class="token operator">:</span> <span class="token number">41.07</span><span class="token punctuation">,</span>
    <span class="token property">&quot;lon&quot;</span><span class="token operator">:</span> <span class="token number">116.64</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><ul><li>lat（经度）</li> <li>lon（纬度）</li></ul> <p>根据（41.07，116.14）坐标，查询100km内的位置信息</p> <div class="language-json extra-class"><pre class="language-json"><code>GET indexname/_search
<span class="token punctuation">{</span>
  <span class="token property">&quot;query&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;geo_distance&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">&quot;distance&quot;</span><span class="token operator">:</span> <span class="token string">&quot;100km&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;location&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;lat&quot;</span><span class="token operator">:</span> <span class="token number">41.07</span><span class="token punctuation">,</span>
        <span class="token property">&quot;lon&quot;</span><span class="token operator">:</span> <span class="token number">116.14</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>根据（23.6,32.2）位置，对查询结果进行远近排序</p> <div class="language-json extra-class"><pre class="language-json"><code>GET indexname/_search
<span class="token punctuation">{</span>
  <span class="token property">&quot;query&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;match_all&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">&quot;sort&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
      <span class="token property">&quot;_geo_distance&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;location&quot;</span><span class="token operator">:</span> <span class="token string">&quot;23.6,32.2&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;unit&quot;</span><span class="token operator">:</span> <span class="token string">&quot;km&quot;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre></div></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">10/27/2023, 5:51:38 PM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/chapter2/document_operation.html" class="prev">
        2.3 文档数据操作
      </a></span> <span class="next"><a href="/chapter2/segment_word_search.html">
        2.5 分词操作介绍
      </a>
      →
    </span></p></div> <div style="text-align:center;"></div> <div style="text-align:center;"><a target="_blank" href="http://qm.qq.com/cgi-bin/qm/qr?_wv=1027&amp;k=jj_4DEzjFnjnAMhiLJedoETcx7ER2n8F&amp;authKey=hAHOoupY6JeUw1YAabj1T6VVIPBEiA4dEhUTLaKIcXrFH1vzRwRS3VQykRPVf%2FUm&amp;noverify=0&amp;group_code=564759181">点击加入Q群：564759181</a></div> <div class="copyright"><a target="_blank" href="https://beian.miit.gov.cn">豫ICP备2023030173号-1</a></div> <div class="copyright"> 
        版权所有，禁止私自克隆网站。
      </div></main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.dac35002.js" defer></script><script src="/assets/js/4.25d5dc7a.js" defer></script><script src="/assets/js/1.564e4eb6.js" defer></script><script src="/assets/js/28.485f0a88.js" defer></script>
  </body>
</html>
